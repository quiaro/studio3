/*
 * Studio JS Services v0.1.0
 *
 * Copyright (C) 2007-2014 Crafter Software Corporation.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 *
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 *
 */

!function(a,b){"function"==typeof define&&define.amd?define([],b):(a.Crafter=a.Crafter||{},a.Crafter.StudioServices=b())}(this,function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){if("string"==typeof a)return p[a]?p[a](b):j(o(a,b).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!b)return;b.splice?(a=b,b=c,c=null):a=d}return b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n},n.config=function(a){return n(a)},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("almond",function(){}),c("request_agent",[],function(){return function(a,b){return"object"!=typeof module||"object"!=typeof module.exports?b(a):void(module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)})}("undefined"!=typeof window?window:this,function(a){function b(a){var b=a.length,c=u.type(a);return"function"===c||u.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function c(a){var b=x[a]={};return u.each(a.match(w)||[],function(a,c){b[c]=!0}),b}function d(a,b,c,e){var f;if(u.isArray(b))u.each(b,function(b,f){c||z.test(a)?e(a,f):d(a+"["+("object"==typeof f?b:"")+"]",f,c,e)});else if(c||"object"!==u.type(b))e(a,b);else for(f in b)d(a+"["+f+"]",b[f],c,e)}function e(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(w)||[];if(u.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function f(a,b,c,d){function e(h){var i;return f[h]=!0,u.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===M;return e(b.dataTypes[0])||!f["*"]&&e("*")}function g(a,b){var c,d,e=u.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&u.extend(!0,a,d),a}function h(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function i(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}var j=[],k=j.slice,l=j.concat,m=j.push,n=j.indexOf,o={},p=o.toString,q=o.hasOwnProperty,r="".trim,s={},t=a.document,u={},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;u.fn=u.prototype={},u.extend=u.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||u.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(u.isPlainObject(d)||(e=u.isArray(d)))?(e?(e=!1,f=c&&u.isArray(c)?c:[]):f=c&&u.isPlainObject(c)?c:{},g[b]=u.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},u.extend({isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===u.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isPlainObject:function(a){return"object"!==u.type(a)||a.nodeType||u.isWindow(a)?!1:a.constructor&&!q.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?o[p.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=u.trim(a),a&&(1===a.indexOf("use strict")?(b=t.createElement("script"),b.text=a,t.head.appendChild(b).parentNode.removeChild(b)):c(a))},each:function(a,c,d){var e,f=0,g=a.length,h=b(a);if(d){if(h)for(;g>f&&(e=c.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=c.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=c.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=c.call(a[f],f,a[f]),e===!1)break;return a},trim:r&&!r.call("﻿ ")?function(a){return null==a?"":r.call(a)}:function(a){return null==a?"":(a+"").replace(v,"")},makeArray:function(a,c){var d=c||[];return null!=a&&(b(Object(a))?u.merge(d,"string"==typeof a?[a]:a):m.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:n.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,c,d){var e,f=0,g=a.length,h=b(a),i=[];if(h)for(;g>f;f++)e=c(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=c(a[f],f,d),null!=e&&i.push(e);return l.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),u.isFunction(a)?(d=k.call(arguments,2),e=function(){return a.apply(b||this,d.concat(k.call(arguments)))},e.guid=a.guid=a.guid||u.guid++,e):void 0},now:Date.now,support:s}),u.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){o["[object "+b+"]"]=b.toLowerCase()});var w=/\S+/g,x={};u.Callbacks=function(a){a="string"==typeof a?x[a]||c(a):u.extend({},a);var b,d,e,f,g,h,i=[],j=!a.once&&[],k=function(c){for(b=a.memory&&c,d=!0,h=f||0,f=0,g=i.length,e=!0;i&&g>h;h++)if(i[h].apply(c[0],c[1])===!1&&a.stopOnFalse){b=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function d(b){u.each(b,function(b,c){var e=u.type(c);"function"===e?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==e&&d(c)})}(arguments),e?g=i.length:b&&(f=c,k(b))}return this},remove:function(){return i&&u.each(arguments,function(a,b){for(var c;(c=u.inArray(b,i,c))>-1;)i.splice(c,1),e&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?u.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],g=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||d&&!j||(b=b||[],b=[a,b.slice?b.slice():b],e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!d}};return l},u.extend({Deferred:function(a){var b=[["resolve","done",u.Callbacks("once memory"),"resolved"],["reject","fail",u.Callbacks("once memory"),"rejected"],["notify","progress",u.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return u.Deferred(function(c){u.each(b,function(b,f){var g=u.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&u.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?u.extend(a,d):d}},e={};return d.pipe=d.then,u.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=k.call(arguments),g=f.length,h=1!==g||a&&u.isFunction(a.promise)?g:0,i=1===h?a:u.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?k.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&u.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var y=/%20/g,z=/\[\]$/;u.param=function(a,b){var c,e=[],f=function(a,b){b=u.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=u.ajaxSettings&&u.ajaxSettings.traditional),u.isArray(a)||a.jquery&&!u.isPlainObject(a))u.each(a,function(){f(this.name,this.value)});else for(c in a)d(c,a[c],b,f);return e.join("&").replace(y,"+")};var A=u.now(),B=/\?/;u.parseJSON=function(a){return JSON.parse(a+"")},u.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&u.error("Invalid XML: "+a),b};var C,D,E=/#.*$/,F=/([?&])_=[^&]*/,G=/^(.*?):[ \t]*([^\r\n]*)$/gm,H=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,I=/^(?:GET|HEAD)$/,J=/^\/\//,K=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,L={},M={},N="*/".concat("*");try{D=location.href}catch(O){D=t.createElement("a"),D.href="",D=D.href}C=K.exec(D.toLowerCase())||[],u.extend({lastModified:{},etag:{},ajaxSettings:{url:D,type:"GET",isLocal:H.test(C[1]),processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":N,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":u.parseJSON,"text xml":u.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?g(g(a,u.ajaxSettings),b):g(u.ajaxSettings,a)},ajaxPrefilter:e(L),ajaxTransport:e(M),ajax:function(a,b){function c(a,b,c,f){var j,l,m,s,t,w=b;2!==v&&(v=2,k&&clearTimeout(k),d=void 0,g=f||"",y.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(s=h(n,y,c)),s=i(n,s,y,j),j?(n.ifModified&&(t=y.getResponseHeader("Last-Modified"),t&&(u.lastModified[e]=t),t=y.getResponseHeader("etag"),t&&(u.etag[e]=t)),204===a||"HEAD"===n.type?w="nocontent":304===a?w="notmodified":(w=s.state,l=s.data,m=s.error,j=!m)):(m=w,(a||!w)&&(w="error",0>a&&(a=0))),y.status=a,y.statusText=(b||w)+"",j?p.resolveWith(o,[l,w,y]):p.rejectWith(o,[y,w,m]),y.statusCode(r),r=void 0,q.fireWith(o,[y,w]))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,g,j,k,l,m,n=u.ajaxSetup({},b),o=n.context||n,p=u.Deferred(),q=u.Callbacks("once memory"),r=n.statusCode||{},s={},t={},v=0,x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(2===v){if(!j)for(j={};b=G.exec(g);)j[b[1].toLowerCase()]=b[2];b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===v?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return v||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return v||(n.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>v)for(b in a)r[b]=[r[b],a[b]];else y.always(a[y.status]);return this},abort:function(a){var b=a||x;return d&&d.abort(b),c(0,b),this}};if(p.promise(y).complete=q.add,y.success=y.done,y.error=y.fail,n.url=((a||n.url||D)+"").replace(E,"").replace(J,C[1]+"//"),n.type=b.method||b.type||n.method||n.type,n.dataTypes=u.trim(n.dataType||"*").toLowerCase().match(w)||[""],null==n.crossDomain&&(l=K.exec(n.url.toLowerCase()),n.crossDomain=!(!l||l[1]===C[1]&&l[2]===C[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(C[3]||("http:"===C[1]?"80":"443")))),n.data&&n.processData&&"string"!=typeof n.data&&(n.data=u.param(n.data,n.traditional)),f(L,n,b,y),2===v)return y;n.type=n.type.toUpperCase(),n.hasContent=!I.test(n.type),e=n.url,n.hasContent||(n.data&&(e=n.url+=(B.test(e)?"&":"?")+n.data,delete n.data),n.cache===!1&&(n.url=F.test(e)?e.replace(F,"$1_="+A++):e+(B.test(e)?"&":"?")+"_="+A++)),n.ifModified&&(u.lastModified[e]&&y.setRequestHeader("If-Modified-Since",u.lastModified[e]),u.etag[e]&&y.setRequestHeader("If-None-Match",u.etag[e])),(n.data&&n.hasContent&&n.contentType!==!1||b.contentType)&&y.setRequestHeader("Content-Type",n.contentType),y.setRequestHeader("Accept",n.dataTypes[0]&&n.accepts[n.dataTypes[0]]?n.accepts[n.dataTypes[0]]+("*"!==n.dataTypes[0]?", "+N+"; q=0.01":""):n.accepts["*"]);for(m in n.headers)y.setRequestHeader(m,n.headers[m]);if(n.beforeSend&&(n.beforeSend.call(o,y,n)===!1||2===v))return y.abort();x="abort";for(m in{success:1,error:1,complete:1})y[m](n[m]);if(d=f(M,n,b,y)){y.readyState=1,n.async&&n.timeout>0&&(k=setTimeout(function(){y.abort("timeout")},n.timeout));try{v=1,d.send(s,c)}catch(z){if(!(2>v))throw z;c(-1,z)}}else c(-1,"No Transport");return y},getJSON:function(a,b,c){return u.get(a,b,c,"json")},getScript:function(a,b){return u.get(a,void 0,b,"script")}}),u.each(["get","post"],function(a,b){u[b]=function(a,c,d,e){return u.isFunction(c)&&(e=e||d,d=c,c=void 0),u.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),u.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var P=0,Q={},R={0:200,1223:204},S=u.ajaxSettings.xhr();return a.ActiveXObject&&a.addEventListener("unload",function(){for(var a in Q)Q[a]()}),s.cors=!!S&&"withCredentials"in S,s.ajax=S=!!S,u.ajaxTransport(function(a){var b;return s.cors||S&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++P;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Q[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(R[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Q[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),u.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return u.globalEval(a),a}}}),u.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),u.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=u("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),t.head.appendChild(b[0])},abort:function(){c&&c()}}}}),u})}),c("serviceError",[],function(){"use strict";return function(a){return Object.create(Error.prototype,{type:{value:a.type||"StudioJSServiceError"},name:{value:"StudioJSServiceError"},message:{value:a.message||""}})}}),c("validation",["request_agent","serviceError"],function(a,b){"use strict";function c(a,c){if(!Array.isArray(c))throw new b({type:"InvalidType",message:"Incorrect value for paramList -expecting an array"});c.forEach(function(c){if(!c.id)throw new b({type:"MissingData",message:"param.id is required for all properties in the parameter list definition of an object"});if(!(c.id in a))throw new b({type:"MissingData",message:"Parameter definition claims missing property '"+c.id+"' exists in object"});c.value=a[c.id],e(c)})}function d(a){var c=a.value,d=a.required,e="boolean"==typeof a.empty?a.empty:!0;if(d){if("undefined"==typeof c||null===c)throw new b({type:"MissingField",message:a.name+" is required, but it is null or undefined"});if(!e&&"string"==typeof c&&!c)throw new b({type:"MissingField",message:a.name+" is required, but it is an empty string"})}}function e(e){var f;if(!e||!a.isPlainObject(e))throw new b({type:"InvalidType",message:"Incorrect value for param -expecting an object"});if(f=e.value,d(e),"undefined"!=typeof f)switch(e.type){case"string":if("string"!=typeof f)throw new b({type:"InvalidType",message:"Incorrect value for "+e.name+" -expecting a string"});break;case"number":if(!a.isNumeric(f))throw new b({type:"InvalidType",message:"Incorrect value for "+e.name+" -expecting a number"});break;case"object":if(!a.isPlainObject(f))throw new b({type:"InvalidType",message:"Incorrect value for "+e.name+" -expecting an object"});e.properties&&c(f,e.properties);break;case"array":if(!Array.isArray(f))throw new b({type:"InvalidType",message:"Incorrect value for "+e.name+" -expecting an array"});break;case"function":if(!a.isFunction(f))throw new b({type:"InvalidType",message:"Incorrect value for "+e.name+" -expecting a function"})}}function f(a){if(!Array.isArray(a))throw new b({type:"InvalidType",message:"Incorrect value for paramList -expecting an array"});a.forEach(function(a){e(a)})}return{validateObject:c,validateParam:e,validateParams:f}}),c("services/asset",["request_agent","../validation"],function(a,b){"use strict";var c=function(a){this.name="Asset",this.utils=a,this.baseUrl=a.getBaseUrl()+"/content/asset"};return c.prototype.create=function(c){var d,e,f,g,h=this.utils.getSite(),i=new FormData;return e=[{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0},{id:"file",name:"property: file",type:"file",required:!0},{id:"mime_type",name:"property: mime_type",type:"string",required:!0}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"asset",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),e.forEach(function(a){var b=a.id;"file"===a.type?i.append(b,c[b],c[b].name):i.append(b,c[b])}),f=this.baseUrl+"/create/"+h,g=a.ajax({contentType:!1,data:i,processData:!1,type:"POST",url:f})},c.prototype.getContent=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/get_content/"+f+"?item_id="+c,e=a.ajax(d)},c.prototype.delete=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/delete/"+f,e=a.post(d,{item_id:c})},c.prototype.duplicate=function(c){var d,e,f,g,h=this.utils.getSite();return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"obj",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),f=this.baseUrl+"/duplicate/"+h,g=a.post(f,c)},c.prototype.find=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"query object",value:c,type:"object",required:!0}]),d=this.baseUrl+"/find/"+f+"?"+a.param(c),e=a.get(d)},c.prototype.move=function(c){var d,e,f,g,h=this.utils.getSite();return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"obj",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),f=this.baseUrl+"/move/"+h,g=a.post(f,c)},c.prototype.read=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/read/"+f+"?item_id="+c,e=a.getJSON(d)},c.prototype.readText=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/read_text/"+f+"?item_id="+c,e=a.get(d)},c.prototype.update=function(c){var d,e,f,g,h=this.utils.getSite(),i=new FormData;return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0},{id:"file",name:"property: file",type:"file",required:!0}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"asset",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),e.forEach(function(a){var b=a.id;"file"===a.type?i.append(b,c[b],c[b].name):i.append(b,c[b])}),f=this.baseUrl+"/update/"+h,g=a.ajax({contentType:!1,data:i,processData:!1,type:"POST",url:f})},c}),c("services/config",["request_agent","../validation"],function(a,b){"use strict";var c=function(a){this.name="Config",this.utils=a,this.baseUrl=a.getBaseUrl()+"/config"};return c.prototype.getDescriptor=function(c){var d,e;return b.validateParams([{name:"module name",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/list/"+c,e=a.getJSON(d)},c.prototype.getPlugins=function(c){var d,e;return b.validateParams([{name:"container name",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/plugins/"+c,e=a.getJSON(d)},c}),c("services/descriptor",["request_agent","../validation"],function(a,b){"use strict";var c=function(a){this.name="Descriptor",this.utils=a,this.baseUrl=a.getBaseUrl()+"/descriptor"};return c.prototype.create=function(c){var d,e,f,g,h=this.utils.getSite(),i=this.baseUrl+"/create/"+h;return f=[{id:"content_type_id",name:"property: content_type_id",type:"string",required:!0},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],e=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"descriptor",value:c,type:"object",required:!0,properties:f}],c.file?(f.push({id:"file",name:"property: file",type:"file",required:!0}),b.validateParams(e),d=new FormData,f.forEach(function(a){var b=a.id;"file"===a.type?d.append(b,c[b],c[b].name):d.append(b,c[b])}),g=a.ajax({contentType:!1,data:d,processData:!1,type:"POST",url:i})):(f.push({id:"content",name:"property: content",type:"string",required:!0,empty:!1}),b.validateParams(e),g=a.post(i,c)),g},c.prototype.delete=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/delete/"+f,e=a.post(d,{item_id:c})},c.prototype.duplicate=function(c){var d,e,f,g,h=this.utils.getSite();return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"obj",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),f=this.baseUrl+"/duplicate/"+h,g=a.post(f,c)},c.prototype.move=function(c){var d,e,f,g,h=this.utils.getSite();return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"obj",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),f=this.baseUrl+"/move/"+h,g=a.post(f,c)},c.prototype.read=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/read/"+f+"?item_id="+c,e=a.getJSON(d)},c.prototype.readText=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/read_text/"+f+"?item_id="+c,e=a.get(d)},c.prototype.update=function(c){var d,e,f,g,h=this.utils.getSite(),i=this.baseUrl+"/update/"+h;return f=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1}],e=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"descriptor",value:c,type:"object",required:!0,properties:f}],c.file?(f.push({id:"file",name:"property: file",type:"file",required:!0}),b.validateParams(e),d=new FormData,f.forEach(function(a){var b=a.id;"file"===a.type?d.append(b,c[b],c[b].name):d.append(b,c[b])}),g=a.ajax({contentType:!1,data:d,processData:!1,type:"POST",url:i})):(f.push({id:"content",name:"property: content",type:"string",required:!0,empty:!1}),b.validateParams(e),g=a.post(i,c)),g},c}),c("services/template",["request_agent","../validation"],function(a,b){"use strict";var c=function(a){this.name="Template",this.utils=a,this.baseUrl=a.getBaseUrl()+"/template"};return c.prototype.create=function(c){var d,e,f,g,h=this.utils.getSite(),i=this.baseUrl+"/create/"+h;return f=[{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],e=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"template",value:c,type:"object",required:!0,properties:f}],c.file?(f.push({id:"file",name:"property: file",type:"file",required:!0}),b.validateParams(e),d=new FormData,f.forEach(function(a){var b=a.id;"file"===a.type?d.append(b,c[b],c[b].name):d.append(b,c[b])}),g=a.ajax({contentType:!1,data:d,processData:!1,type:"POST",url:i})):(f.push({id:"content",name:"property: content",type:"string",required:!0,empty:!1}),b.validateParams(e),g=a.post(i,c)),g},c.prototype.delete=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/delete/"+f,e=a.post(d,{item_id:c})},c.prototype.duplicate=function(c){var d,e,f,g,h=this.utils.getSite();return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"obj",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),f=this.baseUrl+"/duplicate/"+h,g=a.post(f,c)},c.prototype.move=function(c){var d,e,f,g,h=this.utils.getSite();return e=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1},{id:"parent_id",name:"property: parent_id",type:"string",required:!0},{id:"file_name",name:"property: file_name",type:"string",required:!0,empty:!1}],d=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"obj",value:c,type:"object",required:!0,properties:e}],b.validateParams(d),f=this.baseUrl+"/move/"+h,g=a.post(f,c)},c.prototype.read=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/read/"+f+"?item_id="+c,e=a.getJSON(d)},c.prototype.readText=function(c){var d,e,f=this.utils.getSite();return b.validateParams([{name:"site name",value:f,type:"string",required:!0,empty:!1},{name:"itemId",value:c,type:"string",required:!0,empty:!1}]),d=this.baseUrl+"/read_text/"+f+"?item_id="+c,e=a.get(d)},c.prototype.update=function(c){var d,e,f,g,h=this.utils.getSite(),i=this.baseUrl+"/update/"+h;return f=[{id:"item_id",name:"property: item_id",type:"string",required:!0,empty:!1}],e=[{name:"site name",value:h,type:"string",required:!0,empty:!1},{name:"template",value:c,type:"object",required:!0,properties:f}],c.file?(f.push({id:"file",name:"property: file",type:"file",required:!0}),b.validateParams(e),d=new FormData,f.forEach(function(a){var b=a.id;"file"===a.type?d.append(b,c[b],c[b].name):d.append(b,c[b])}),g=a.ajax({contentType:!1,data:d,processData:!1,type:"POST",url:i})):(f.push({id:"content",name:"property: content",type:"string",required:!0,empty:!1}),b.validateParams(e),g=a.post(i,c)),g},c}),c("config",{server:{domain:"",port:"",protocol:"http:"},site:"",api:{version:1,base:"api"}}),c("utils",["request_agent","config"],function(a,b){"use strict";var c=function(c){this.config=a.extend(!0,{},b,c)};return c.prototype.getBaseUrl=function(a){var b,c,d,e,f=[],g=a||{};return b=window&&window.location||{},c=g.protocol||this.config.server.protocol||b.protocol,d=g.domain||this.config.server.domain||b.hostname,e=g.port?g.port:"number"==typeof this.config.server.port||"string"==typeof this.config.server.port&&!isNaN(+this.config.server.port)?this.config.server.port:b.port,c&&d&&(f.push(c),f.push("//"),f.push(d),e&&(f.push(":"),f.push(e))),f.push("/"),f.push(this.config.api.base),f.push("/"),f.push(this.config.api.version),f.join("")},c.prototype.getSite=function(){return this.config.site},c.prototype.mergePath=function(a,b){return-1!==b.indexOf("://")?b:0===b.indexOf("/")?a+b:a+"/"+b},c.prototype.setSite=function(a){if("string"==typeof a&&a)return this.config.site=a,this.config.site;throw new Error("Incorrect value for site name")},c}),c("studioServices",["services/asset","services/config","services/descriptor","services/template","utils"],function(a,b,c,d,e){"use strict";return function(f){var g=new e(f),h=new a(g),i=new b(g),j=new c(g),k=new d(g);return Object.freeze({Asset:h,Config:i,Descriptor:j,Template:k,Utils:g})}}),b("studioServices")});
//# sourceMappingURL=studioServices.min.map